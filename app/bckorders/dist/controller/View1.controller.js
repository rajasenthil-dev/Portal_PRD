sap.ui.define(["sap/ui/core/mvc/Controller","bckorders/model/formatter","sap/m/MessageBox"],(e,t,o)=>{"use strict";return e.extend("bckorders.controller.View1",{formatter:t,onInit:function(){var e=this.getOwnerComponent().getModel();e.attachRequestFailed(function(e){var t=e.getParameters();if(t.response.statusCode==="403"){o.error("You currently do not have authorization to view this resource. If you feel this in incorrect please reach out to the administrator.")}else{o.error("An error occurred: "+t.response.message)}});const t=this.getView().byId("table0");const r=t.getTable();r.attachEvent("rowsUpdated",this._calculateTotals.bind(this))},onGetManufacturerMedia:function(e){var t=this.getView().getModel("logo");var o=t.bindList("/MediaFile",undefined,undefined);o.requestContexts().then(function(e){if(e.length>0){var t=e[0].getObject();console.log("Manufacturer:",t.MFGName);console.log("File URL:",t.url);var o=sap.ui.require.toUrl("bckorders").split("/resources")[0];if(o==="."){o=""}console.log("âœ… Dynamic Base Path:",o);var r=o+t.url;this.getView().byId("logoImage").setSrc(r)}else{console.log("No media found for this manufacturer.")}}.bind(this))},_calculateTotals:function(){this.onGetManufacturerMedia();const e=this.getView().byId("table0");const t=e.getTable();const o=t.getBinding("rows");if(!o){console.warn("Table binding is missing.");return}const r=o.getContexts(0,o.getLength());if(!r){console.warn("Data is not available for calculation.");return}const n=r.reduce((e,t)=>{const o=t.getObject();if(!o)return e;e.totalBackOrders++;e.impactedCustomers.add(o.KUNRE_ANA);e.totalItemsOnBackOrder.add(o.MATNR);e.totalUnitsBackOrdered+=parseFloat(o.BACK_ORD_QTY||0);e.totalExtension+=parseFloat(o.EXTENSION||0);if(o.DATE_DIFF>0&&!o.UDATE){e.totalUnitsToBeReceived+=parseFloat(o.BACK_ORD_QTY||0)}return e},{totalBackOrders:0,impactedCustomers:new Set,totalItemsOnBackOrder:new Set,totalUnitsBackOrdered:0,totalUnitsToBeReceived:0,totalExtension:0});const a=n.impactedCustomers.size;const s=n.totalItemsOnBackOrder.size;const i=this.formatter.formatCurrency(n.totalExtension,"USD");const l=this.formatter.formatNumber(n.totalUnitsBackOrdered);this._updateTile("TileContent1",n.totalBackOrders);this._updateTile("TileContent2",a);this._updateTile("TileContent3",s);this._updateTile("TileContent4",n.totalUnitsBackOrdered);this._updateTile("TileContent5",n.totalUnitsToBeReceived);this._updateFooter("footerText1",l);this._updateFooter("footerText2",i)},_updateTile:function(e,t){const o=this.byId(e);if(o){o.setText(t)}else{console.warn(`Tile with ID ${e} not found.`)}},_updateFooter:function(e,t){const o=this.byId(e);if(o){o.setText(t)}else{console.warn(`Footer with ID ${e} not found.`)}}})});
//# sourceMappingURL=View1.controller.js.map